<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Activar Widget · Sistema Notion Grid</title>
  <style>
    :root { --bg:#0b0c10; --card:#111216; --muted:#a5adba; --text:#e6e8ec; --accent:#76e8c6; }
    *{box-sizing:border-box} body{margin:0; font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial; background:#0b0c10; color:var(--text)}
    .wrap{max-width:680px; margin:40px auto; padding:0 16px}
    .card{background:var(--card); border:1px solid #1b1f2a; border-radius:16px; padding:18px}
    label{display:block; font-weight:600; margin:10px 0 6px}
    input{width:100%; padding:10px 12px; border-radius:10px; border:1px solid #263149; background:#0f121a; color:#e6e8ec}
    button{margin-top:12px; padding:10px 14px; border-radius:10px; border:1px solid #254a3d; background:#10231c; color:#c8ffee; font-weight:700; cursor:pointer}
    .note{color:var(--muted); font-size:13px}
    .out{margin-top:12px; white-space:pre-wrap; background:#0e1218; border:1px solid #1a2130; border-radius:10px; padding:10px}
    a.back{display:inline-block; margin-top:16px; color:#cfd6ff; text-decoration:none; border:1px solid #273046; padding:9px 12px; border-radius:10px; background:#121522}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Activar Widget</h1>
    <p class="note">Demo de formulario para solicitar un <em>Magic Link</em>. Ajusta el endpoint en el código si tu backend usa otra ruta.</p>
    <div class="card">
      <label for="email">Tu email</label>
      <input id="email" type="email" placeholder="tu@correo.com" />
      <label for="workspace">Workspace / Notion DB</label>
      <input id="workspace" type="text" placeholder="ID de la base" />
      <button id="btn">Generar Magic Link</button>
      <div id="out" class="out" hidden></div>
    </div>
    <a class="back" href="/">← Volver</a>
  </div>
  <script>
    const $btn = document.getElementById('btn');
    const $out = document.getElementById('out');
    $btn.onclick = async () => {
      const email = document.getElementById('email').value.trim();
      const workspace = document.getElementById('workspace').value.trim();
      if (!email) { alert('Escribe tu email'); return; }

      try {
        // Ajusta la ruta a la que exponga tu backend el endpoint de magic link.
        const res = await fetch('/api/magic-link', {
          method: 'POST',
          headers: { 'Content-Type':'application/json' },
          body: JSON.stringify({ email, workspace })
        });
        const data = await res.json().catch(()=>({}));
        $out.hidden = false;
        $out.textContent = 'Respuesta:\n' + JSON.stringify(data, null, 2);
      } catch (e) {
        $out.hidden = false;
        $out.textContent = 'Error al solicitar Magic Link.\n' + e;
      }
    };
  </script>
</body>
</html>
